<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Learn & Earn</title>
  <style>
    #lessonModal {
      display: none;
      position: fixed;
      top: 20%;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      max-width: 400px;
      background: white;
      border: 2px solid #007bff;
      padding: 20px;
      z-index: 9999;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      border-radius: 10px;
    }
    .modal-header {
      font-weight: bold;
      font-size: 18px;
      margin-bottom: 10px;
      color: #007bff;
    }
    .modal-body {
      font-size: 16px;
      margin-bottom: 10px;
    }
    .modal-footer {
      text-align: right;
    }
    .audio-controls button {
      margin-right: 5px;
      padding: 5px 10px;
      font-size: 14px;
    }
    #learnBtn {
      padding: 10px 20px;
      background-color: green;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<!-- Button to trigger modal -->
<button id="learnBtn">Learn & Earn</button>

<!-- Modal -->
<div id="lessonModal">
  <div class="modal-header">What is Cryptocurrency?</div>
  <div class="modal-body" id="lessonContent">
    Cryptocurrency is a digital form of money that operates on a decentralized network called blockchain.
    It allows for peer-to-peer transactions without the need for banks. Popular cryptocurrencies include Bitcoin, Ethereum, and USDT. [ Learn more ]
  </div>
  <div class="audio-controls">
    <button onclick="playAudio()">▶️ Listen</button>
    <button onclick="pauseAudio()">⏸️ Pause</button>
    <button onclick="resumeAudio()">▶️ Resume</button>
    <button onclick="stopAudio()">⏹️ Stop</button>
  </div>
  <div class="modal-footer">
    <button onclick="closeModal()">Close</button>
  </div>
</div>

<script>
  let utterance;

  document.getElementById("learnBtn").addEventListener("click", function() {
    document.getElementById("lessonModal").style.display = "block";
  });

  function closeModal() {
    stopAudio();
    document.getElementById("lessonModal").style.display = "none";
  }

  function playAudio() {
    const lessonText = document.getElementById("lessonContent").innerText;

    const cutoffText = lessonText.split('[ Learn more ]')[0].trim();

    if (!cutoffText) {
      alert("No lesson content to read.");
      return;
    }

    window.speechSynthesis.cancel();

    utterance = new SpeechSynthesisUtterance(cutoffText);
    utterance.lang = 'en-US';

    const voices = window.speechSynthesis.getVoices();
    const preferredVoice = voices.find(v => v.name.includes("Google")) || voices[0];
    if (preferredVoice) utterance.voice = preferredVoice;

    window.speechSynthesis.speak(utterance);
  }

  function pauseAudio() {
    if (window.speechSynthesis.speaking) {
      window.speechSynthesis.pause();
    }
  }

  function resumeAudio() {
    if (window.speechSynthesis.paused) {
      window.speechSynthesis.resume();
    }
  }

  function stopAudio() {
    window.speechSynthesis.cancel();
  }
</script>

</body>
</html>
