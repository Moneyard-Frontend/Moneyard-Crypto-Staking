<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Deposit Approval</title>
  <style>
    body { font-family: Arial, sans-serif; background: #fff; padding: 20px; }
    .box { border: 1px solid #ccc; padding: 20px; border-radius: 10px; max-width: 600px; margin: auto; margin-bottom: 20px; }
    h2 { color: #007b8f; }
    .status { font-weight: bold; margin-top: 10px; }
    button { background: #28a745; color: white; padding: 8px 16px; border: none; border-radius: 5px; cursor: pointer; margin-top: 10px; }
    .reset-btn { background: #dc3545; }
  </style>
</head>
<body>

  <h2 style="text-align:center;">All Deposit Requests</h2>
  <div id="history"></div>

  <div style="text-align:center;">
    <button class="reset-btn" onclick="resetHistory()">Reset All Deposits</button>
  </div>

  <script>
    let deposits = JSON.parse(localStorage.getItem("depositRequests")) || [];

    const historyDiv = document.getElementById("history");

    if (deposits.length === 0) {
      historyDiv.innerHTML = "<p style='text-align:center;'>No deposit records found.</p>";
    } else {
      deposits.forEach((deposit, index) => {
  const box = document.createElement("div");
  box.className = "box";
  box.innerHTML = `
    <p><strong>Payment Method:</strong> ${deposit.method}</p>
    <p><strong>Amount:</strong> ZMW ${deposit.amount}</p>
    <p><strong>Transaction ID:</strong> ${deposit.txid}</p>
    <p><strong>Date:</strong> ${deposit.date}</p>
    <p class="status" id="status-${deposit.id}">Status: ${deposit.status}</p>
    ${deposit.status === "Pending" ? `<button onclick="approveDeposit(${deposit.id})">Approve</button>` : ""}
  `;
  historyDiv.appendChild(box);
});
    function approveDeposit(id) {
  const password = prompt("Enter approval password:");
  const correctPassword = "admin123"; // Set your frontend-only password

  if (password !== correctPassword) {
    alert("Incorrect password. Approval denied.");
    return;
  }

  const depositIndex = deposits.findIndex(d => d.id === id);
  if (depositIndex !== -1) {
    deposits[depositIndex].status = "Approved";
    localStorage.setItem("depositRequests", JSON.stringify(deposits));
    document.getElementById(`status-${id}`).innerText = "Status: Approved";
    alert("Deposit approved!");
    location.reload();
  }
}
    function resetHistory() {
      if (confirm("Are you sure you want to clear all deposit history?")) {
        localStorage.removeItem("depositRequests");
        alert("All deposits cleared.");
        location.reload();
      }
    }
  </script>
</body>
</html>
